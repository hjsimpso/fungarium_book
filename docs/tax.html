<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Taxonomic analysis | fungarium: Enabling the use of fungaria collections data for comprehensive trait analyses in R</title>
  <meta name="description" content="A guide to using fungarium for comprehensive analyses of ecological traits in fungi." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Taxonomic analysis | fungarium: Enabling the use of fungaria collections data for comprehensive trait analyses in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A guide to using fungarium for comprehensive analyses of ecological traits in fungi." />
  <meta name="github-repo" content="hjsimpso/fungarium" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Taxonomic analysis | fungarium: Enabling the use of fungaria collections data for comprehensive trait analyses in R" />
  
  <meta name="twitter:description" content="A guide to using fungarium for comprehensive analyses of ecological traits in fungi." />
  

<meta name="author" content="Hunter J. Simpson" />


<meta name="date" content="2021-04-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<link rel="prev" href="intro.html"/>
<link rel="next" href="geo.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">fungarium</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#getting-started"><i class="fa fa-check"></i><b>1.2</b> Getting started</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#installing-fungarium"><i class="fa fa-check"></i><b>1.2.1</b> Installing fungarium</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#installing-docker"><i class="fa fa-check"></i><b>1.2.2</b> Installing Docker</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#retrieving-mycoportal-data"><i class="fa fa-check"></i><b>1.2.3</b> Retrieving MyCoPortal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tax.html"><a href="tax.html"><i class="fa fa-check"></i><b>2</b> Taxonomic analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tax.html"><a href="tax.html#update-taxon-names-and-clean-up"><i class="fa fa-check"></i><b>2.1</b> Update taxon names and clean up</a></li>
<li class="chapter" data-level="2.2" data-path="tax.html"><a href="tax.html#calculating-trait-enrichment-factors"><i class="fa fa-check"></i><b>2.2</b> Calculating trait enrichment factors</a></li>
<li class="chapter" data-level="2.3" data-path="tax.html"><a href="tax.html#visualize-trait-enrichment-factors"><i class="fa fa-check"></i><b>2.3</b> Visualize trait enrichment factors</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="geo.html"><a href="geo.html"><i class="fa fa-check"></i><b>3</b> Geographic analysis</a></li>
<li class="chapter" data-level="4" data-path="tem.html"><a href="tem.html"><i class="fa fa-check"></i><b>4</b> Temporal analysis</a></li>
<li class="chapter" data-level="5" data-path="conc.html"><a href="conc.html"><i class="fa fa-check"></i><b>5</b> Final Words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">fungarium: Enabling the use of fungaria collections data for comprehensive trait analyses in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tax" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Taxonomic analysis</h1>
<div id="update-taxon-names-and-clean-up" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Update taxon names and clean up</h2>
<p>Some MyCoPortal records will have outdated or invalid taxonomy; therefore, all taxon names need to be either updated or confirmed using currently accepted taxonomic classification (e.g., <a href="https://www.gbif.org/dataset/d7dddbf4-2cf0-4f39-9b2a-bb099caae36c">GBIF backbone taxonomy</a>) prior to trait analyses. In the example below, records not identified to the species level are removed from the data set. This helps avoid taxonomy uncertain issues, which are described in more detail by <span class="citation"><a href="references.html#ref-fungarium2021" role="doc-biblioref">Simpson and Schilling</a> (<a href="references.html#ref-fungarium2021" role="doc-biblioref">2021</a>)</span>.</p>
<p>After updating taxonomy, some records may now be classified outside of the taxonomic group that was originally queried. These records need to be removed if your analysis is to focus on the queried taxonomic group only.</p>
<p><strong>Example code for updating taxon names and cleaning up data set:</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="tax.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fungarium)</span>
<span id="cb3-2"><a href="tax.html#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="tax.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#import sample data set</span></span>
<span id="cb3-4"><a href="tax.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(strophariaceae) <span class="co">#global Strophariaceae records</span></span>
<span id="cb3-5"><a href="tax.html#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="tax.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#see Table 2.1 for preview of Strophariaceae data set</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:stroph-tab">Table 2.1: </span>Preview of Strophariaceae data set
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
institutionCode
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
scientificName
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
scientificNameAuthorship
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
recordedBy
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
associatedCollectors
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
year
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
eventDate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
occurrenceRemarks
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
habitat
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
substrate
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
host
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
stateProvince
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
county
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
decimalLatitude
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
decimalLongitude
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
references
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
267249
</td>
<td style="text-align:left;">
TENN-F
</td>
<td style="text-align:left;">
Naematoloma capnoides
</td>
<td style="text-align:left;">
(Fr.) P. Karst.
</td>
<td style="text-align:left;">
G. Mueller
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
1981
</td>
<td style="text-align:left;">
1981-09-12
</td>
<td style="text-align:left;">
Notes with specimen
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
United States
</td>
<td style="text-align:left;">
Colorado
</td>
<td style="text-align:left;">
Larimer
</td>
<td style="text-align:left;">
40.60416667
</td>
<td style="text-align:left;">
-105.8458333
</td>
<td style="text-align:left;">
<a href="https://mycoportal.org:443/portal/collections/individual/index.php?occid=267249" class="uri">https://mycoportal.org:443/portal/collections/individual/index.php?occid=267249</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
2365568
</td>
<td style="text-align:left;">
WTU
</td>
<td style="text-align:left;">
Psilocybe weillii
</td>
<td style="text-align:left;">
Guzman, Stamets &amp; Tapia
</td>
<td style="text-align:left;">
P. Stamets
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
1995
</td>
<td style="text-align:left;">
1995-09-00
</td>
<td style="text-align:left;">
Isotype. Substrate: terricolous.
</td>
<td style="text-align:left;">
Underneath Liquidambar and Pinus, in red clay soil enriched with pine needles.
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
U.S.A.
</td>
<td style="text-align:left;">
Georgia
</td>
<td style="text-align:left;">
Cherokee
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<a href="https://mycoportal.org:443/portal/collections/individual/index.php?occid=2365568" class="uri">https://mycoportal.org:443/portal/collections/individual/index.php?occid=2365568</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
8143194
</td>
<td style="text-align:left;">
MUOB
</td>
<td style="text-align:left;">
Galerina marginata
</td>
<td style="text-align:left;">
(Batsch) Kühner
</td>
<td style="text-align:left;">
MiWoods
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
2017
</td>
<td style="text-align:left;">
2017-10-14
</td>
<td style="text-align:left;">
Found in mulch, 65°F average, rainy days. Have photos of all angles, in the process of spore printing on foil.
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
United States
</td>
<td style="text-align:left;">
Michigan
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
44.0181
</td>
<td style="text-align:left;">
-84.7806
</td>
<td style="text-align:left;">
<a href="https://mycoportal.org:443/portal/collections/individual/index.php?occid=8143194" class="uri">https://mycoportal.org:443/portal/collections/individual/index.php?occid=8143194</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
8066746
</td>
<td style="text-align:left;">
MUOB
</td>
<td style="text-align:left;">
Gymnopilus lepidotus
</td>
<td style="text-align:left;">
Hesler
</td>
<td style="text-align:left;">
Richard Kneal
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
2014
</td>
<td style="text-align:left;">
2014-07-27
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
United States
</td>
<td style="text-align:left;">
Florida
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
29.6781
</td>
<td style="text-align:left;">
-82.3312
</td>
<td style="text-align:left;">
<a href="https://mycoportal.org:443/portal/collections/individual/index.php?occid=8066746" class="uri">https://mycoportal.org:443/portal/collections/individual/index.php?occid=8066746</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
7629417
</td>
<td style="text-align:left;">
NY
</td>
<td style="text-align:left;">
Agrocybe smithii
</td>
<td style="text-align:left;">
Watling &amp; H.E. Bigelow
</td>
<td style="text-align:left;">
H. E. Ahles
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
1970
</td>
<td style="text-align:left;">
1970-04-28
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
United States of America
</td>
<td style="text-align:left;">
California
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
<a href="https://mycoportal.org:443/portal/collections/individual/index.php?occid=7629417" class="uri">https://mycoportal.org:443/portal/collections/individual/index.php?occid=7629417</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
452739
</td>
<td style="text-align:left;">
MICH
</td>
<td style="text-align:left;">
Pholiota decorata
</td>
<td style="text-align:left;">
(Murrill) A.H. Sm. &amp; Hesler
</td>
<td style="text-align:left;">
A. H. Smith
</td>
<td style="text-align:left;">
D. &amp; C. Goetz
</td>
<td style="text-align:left;">
1970
</td>
<td style="text-align:left;">
1970-11-12
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
USA
</td>
<td style="text-align:left;">
Oregon
</td>
<td style="text-align:left;">
Tillamook
</td>
<td style="text-align:left;">
45.0445
</td>
<td style="text-align:left;">
-123.8013
</td>
<td style="text-align:left;">
<a href="https://mycoportal.org:443/portal/collections/individual/index.php?occid=452739" class="uri">https://mycoportal.org:443/portal/collections/individual/index.php?occid=452739</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
2817241
</td>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
Pholiota squarrosa
</td>
<td style="text-align:left;">
(Vahl) P. Kumm.
</td>
<td style="text-align:left;">
E. T. Harper &amp; S. A. Harper
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
1911
</td>
<td style="text-align:left;">
1911-08-18
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
U.S.A.
</td>
<td style="text-align:left;">
Michigan
</td>
<td style="text-align:left;">
Chippewa
</td>
<td style="text-align:left;">
46.2833
</td>
<td style="text-align:left;">
-84.15
</td>
<td style="text-align:left;">
<a href="https://mycoportal.org:443/portal/collections/individual/index.php?occid=2817241" class="uri">https://mycoportal.org:443/portal/collections/individual/index.php?occid=2817241</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
7994039
</td>
<td style="text-align:left;">
MUOB
</td>
<td style="text-align:left;">
Hypholoma capnoides
</td>
<td style="text-align:left;">
(Fr.) P. Kumm.
</td>
<td style="text-align:left;">
Tim Sage
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
2010
</td>
<td style="text-align:left;">
2010-02-12
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
United States
</td>
<td style="text-align:left;">
Washington
</td>
<td style="text-align:left;">
King
</td>
<td style="text-align:left;">
47.7411
</td>
<td style="text-align:left;">
-122.3025
</td>
<td style="text-align:left;">
<a href="https://mycoportal.org:443/portal/collections/individual/index.php?occid=7994039" class="uri">https://mycoportal.org:443/portal/collections/individual/index.php?occid=7994039</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
8044947
</td>
<td style="text-align:left;">
MUOB
</td>
<td style="text-align:left;">
Hypholoma fasciculare
</td>
<td style="text-align:left;">
(Huds.) P. Kumm.
</td>
<td style="text-align:left;">
Nihilist
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
2013
</td>
<td style="text-align:left;">
2013-06-19
</td>
<td style="text-align:left;">
Just wanted to add some pictures to the database of some older ones.
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
United States
</td>
<td style="text-align:left;">
Ohio
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
40.07
</td>
<td style="text-align:left;">
-82.64
</td>
<td style="text-align:left;">
<a href="https://mycoportal.org:443/portal/collections/individual/index.php?occid=8044947" class="uri">https://mycoportal.org:443/portal/collections/individual/index.php?occid=8044947</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
3902763
</td>
<td style="text-align:left;">
OSC
</td>
<td style="text-align:left;">
Nivatogastrium nubigenum
</td>
<td style="text-align:left;">
(Harkn.) Singer &amp; A.H. Sm.
</td>
<td style="text-align:left;">
Carlisle
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
2000
</td>
<td style="text-align:left;">
2000-06-07
</td>
<td style="text-align:left;">
No additional notes on file.
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Substrate: Abies magnifica var shastensis wood
</td>
<td style="text-align:left;">
Abies magnifica var shastensis
</td>
<td style="text-align:left;">
United States
</td>
<td style="text-align:left;">
Oregon
</td>
<td style="text-align:left;">
Klamath
</td>
<td style="text-align:left;">
42.883
</td>
<td style="text-align:left;">
-121.9277
</td>
<td style="text-align:left;">
<a href="https://mycoportal.org:443/portal/collections/individual/index.php?occid=3902763" class="uri">https://mycoportal.org:443/portal/collections/individual/index.php?occid=3902763</a>
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="tax.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#update names and classification</span></span>
<span id="cb4-2"><a href="tax.html#cb4-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">taxon_update</span>(strophariaceae, <span class="at">species_only=</span><span class="cn">TRUE</span>, <span class="at">show_status=</span><span class="cn">FALSE</span>) </span>
<span id="cb4-3"><a href="tax.html#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="tax.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#remove records no longer classified in Strophariaceae</span></span>
<span id="cb4-5"><a href="tax.html#cb4-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>new_family<span class="sc">==</span><span class="st">&quot;Strophariaceae&quot;</span>,] </span>
<span id="cb4-6"><a href="tax.html#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="tax.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#remove records with taxon names that could not be updated or confirmed</span></span>
<span id="cb4-8"><a href="tax.html#cb4-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>new_name<span class="sc">!=</span><span class="st">&quot;&quot;</span>,]</span></code></pre></div>
<p>Note that taxon name updating and filtering was done prior to the taxonomic, geographic, and temporal analyses done by <span class="citation"><a href="references.html#ref-fungarium2021" role="doc-biblioref">Simpson and Schilling</a> (<a href="references.html#ref-fungarium2021" role="doc-biblioref">2021</a>)</span>. This is not necessarily required for geographic and temporal analyses; however, you run the risk of including “bad taxa” (i.e. taxa that are not actually classified within your originally specified taxonomic group) in your analyses. Thus, it is recommended to update taxon names and filter before performing any downstream analyses.</p>
</div>
<div id="calculating-trait-enrichment-factors" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Calculating trait enrichment factors</h2>
<p>To make quantitative trait comparisons between taxa, trait-relevant records are first identified using <code>find_trait</code> and then trait enrichment factors are calculated using <code>enrichment</code>. These enrichment factors correspond to the number of records associated with a certain trait divided by the number of total records for a given taxon. The following example investigates fire-association (i.e., association with fire-affected habitat, hosts, or substrates) as an ecological trait.</p>
<p><strong>Example code for finding trait records and calculating enrichment factors:</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="tax.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#string for finding fire-associated records</span></span>
<span id="cb5-2"><a href="tax.html#cb5-2" aria-hidden="true" tabindex="-1"></a>string1 <span class="ot">&lt;-</span> <span class="st">&quot;(?i)charred|burn(t|ed)|scorched|fire.?(killed|damaged|scarred)|killed.by.fire&quot;</span></span>
<span id="cb5-3"><a href="tax.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="tax.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#string for removing records falsely identified as fire-associated</span></span>
<span id="cb5-5"><a href="tax.html#cb5-5" aria-hidden="true" tabindex="-1"></a>string2 <span class="ot">&lt;-</span> <span class="st">&quot;(?i)un.?burn(t|ed)&quot;</span></span>
<span id="cb5-6"><a href="tax.html#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="tax.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#filter out records that do not contain any environmental metadata (optional)</span></span>
<span id="cb5-8"><a href="tax.html#cb5-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>occurrenceRemarks<span class="sc">!=</span><span class="st">&quot;&quot;</span><span class="sc">|</span>data<span class="sc">$</span>host<span class="sc">!=</span><span class="st">&quot;&quot;</span><span class="sc">|</span></span>
<span id="cb5-9"><a href="tax.html#cb5-9" aria-hidden="true" tabindex="-1"></a>                   data<span class="sc">$</span>habitat<span class="sc">!=</span><span class="st">&quot;&quot;</span><span class="sc">|</span>data<span class="sc">$</span>substrate<span class="sc">!=</span><span class="st">&quot;&quot;</span>,]</span>
<span id="cb5-10"><a href="tax.html#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="tax.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">#find trait-relevant records</span></span>
<span id="cb5-12"><a href="tax.html#cb5-12" aria-hidden="true" tabindex="-1"></a>trait_data <span class="ot">&lt;-</span> <span class="fu">find_trait</span>(data, <span class="at">pos_string=</span>string1, <span class="at">neg_string=</span>string2)</span>
<span id="cb5-13"><a href="tax.html#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="tax.html#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">#get trait enrichment</span></span>
<span id="cb5-15"><a href="tax.html#cb5-15" aria-hidden="true" tabindex="-1"></a>trait_enrichment <span class="ot">&lt;-</span> <span class="fu">enrichment</span>(<span class="at">all_rec=</span>data, <span class="at">trait_rec=</span>trait_data, <span class="at">status_feed=</span><span class="cn">FALSE</span>)</span>
<span id="cb5-16"><a href="tax.html#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="tax.html#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co">#filter taxa based on collector bias (optional)</span></span>
<span id="cb5-18"><a href="tax.html#cb5-18" aria-hidden="true" tabindex="-1"></a>trait_enrichment <span class="ot">&lt;-</span> trait_enrichment[trait_enrichment<span class="sc">$</span>max_bias<span class="sc">&lt;=</span><span class="fl">0.75</span>,]</span>
<span id="cb5-19"><a href="tax.html#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="tax.html#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co">#filter taxa based on total number of records (optional)</span></span>
<span id="cb5-21"><a href="tax.html#cb5-21" aria-hidden="true" tabindex="-1"></a>trait_enrichment <span class="ot">&lt;-</span> trait_enrichment[trait_enrichment<span class="sc">$</span>freq<span class="sc">&gt;=</span><span class="dv">5</span>,]</span></code></pre></div>
<p>Note that there are various optional filtering steps that may be done before and after trait searching and enrichment factor calculation, all of which have the potential to improve the accuracy of enrichment values. In the example above, records that did not contain any environmental metadata were removed prior to trait searching. This helps remove potential false negative records (i.e., records that are in fact associated with the trait of interest but are not identified as such), which negatively impact the enrichment factor accuracy. After trait searching and enrichment factor calculation, there a variety of output fields that can be used for data set filtering.</p>
<p>The “freq” or “trait_freq” output fields correspond to the number of total records and the number of trait-relevant records, respectively, for each unique taxon. These can both be used to filter out taxa that have not been sampled thoroughly enough to calculate trustworthy enrichment values (enrichment values are listed under the “trait_ratio” output field; see <code>enrichment</code> documentation for more details about output fields). For example, a taxon with 50 total records will have a more trustworthy enrichment value than a taxon that has only 5 total records.</p>
<p>The “max_bias” or “coll_groups” output fields correspond to the maximum proportion of records collected by one group of associated collectors and the total number of associated collector groups, respectively. These fields can be used to filter out taxa that have been collected with a high degree of bias, and, thus, may not have trustworthy enrichment values. For example, a taxon with a “max_bias” value of 0.25 will likely have a more trustworthy enrichment value than a taxon with a value of 0.85. See <span class="citation"><a href="references.html#ref-fungarium2021" role="doc-biblioref">Simpson and Schilling</a> (<a href="references.html#ref-fungarium2021" role="doc-biblioref">2021</a>)</span> for more details about how enrichment values can be negatively impacted by collector bias.</p>
</div>
<div id="visualize-trait-enrichment-factors" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Visualize trait enrichment factors</h2>
<p>After trait enrichment factors have been calculated for each species, these values can been visualized within a cladogram using <code>trait_clado</code>. This function generates a cladogram based on the taxonomic classification of each species (up-to-date taxonomic classification is given in the output of <code>taxon_update</code>). Cladogram tip color corresponds to the enrichment value of each species, whereas node color corresponds to the enrichment value of each higher-level taxon in the cladogram. Other tree annotation options are available. See <code>trait_clado</code> documentation for more details.</p>
<p><strong>Example code for making rectangular trait cladogram:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="tax.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load sample enrichment data set for global Agaricales records</span></span>
<span id="cb6-2"><a href="tax.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(agaricales_enrich)</span>
<span id="cb6-3"><a href="tax.html#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="tax.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#see Table 2.2 for preview of Agaricales enrichment data set</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:agar-tab">Table 2.2: </span>Preview of Agaricales enrichment data set
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
new_full_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
new_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
new_author
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
new_kingdom
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
new_phylum
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
new_class
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
new_order
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
new_family
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
new_genus
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
new_specific_epithet
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
freq
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
trait_freq
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
trait_ratio
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
max_bias
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
coll_groups
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
max_bias_t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
coll_groups_t
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Abstoma pampeanum (Speg.) J.E.Wright &amp; V.L.Suárez
</td>
<td style="text-align:left;">
Abstoma pampeanum
</td>
<td style="text-align:left;">
(Speg.) J.E.Wright &amp; V.L.Suárez
</td>
<td style="text-align:left;">
Fungi
</td>
<td style="text-align:left;">
Basidiomycota
</td>
<td style="text-align:left;">
Agaricomycetes
</td>
<td style="text-align:left;">
Agaricales
</td>
<td style="text-align:left;">
Agaricaceae
</td>
<td style="text-align:left;">
Abstoma
</td>
<td style="text-align:left;">
pampeanum
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.2500000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Abstoma purpureum (Lloyd) G.Cunn.
</td>
<td style="text-align:left;">
Abstoma purpureum
</td>
<td style="text-align:left;">
(Lloyd) G.Cunn.
</td>
<td style="text-align:left;">
Fungi
</td>
<td style="text-align:left;">
Basidiomycota
</td>
<td style="text-align:left;">
Agaricomycetes
</td>
<td style="text-align:left;">
Agaricales
</td>
<td style="text-align:left;">
Agaricaceae
</td>
<td style="text-align:left;">
Abstoma
</td>
<td style="text-align:left;">
purpureum
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.7500000
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Abstoma reticulatum G.Cunn.
</td>
<td style="text-align:left;">
Abstoma reticulatum
</td>
<td style="text-align:left;">
G.Cunn.
</td>
<td style="text-align:left;">
Fungi
</td>
<td style="text-align:left;">
Basidiomycota
</td>
<td style="text-align:left;">
Agaricomycetes
</td>
<td style="text-align:left;">
Agaricales
</td>
<td style="text-align:left;">
Agaricaceae
</td>
<td style="text-align:left;">
Abstoma
</td>
<td style="text-align:left;">
reticulatum
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3333333
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Abstoma stuckertii (Speg.) J.E.Wright &amp; V.L.Suárez
</td>
<td style="text-align:left;">
Abstoma stuckertii
</td>
<td style="text-align:left;">
(Speg.) J.E.Wright &amp; V.L.Suárez
</td>
<td style="text-align:left;">
Fungi
</td>
<td style="text-align:left;">
Basidiomycota
</td>
<td style="text-align:left;">
Agaricomycetes
</td>
<td style="text-align:left;">
Agaricales
</td>
<td style="text-align:left;">
Agaricaceae
</td>
<td style="text-align:left;">
Abstoma
</td>
<td style="text-align:left;">
stuckertii
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.3636364
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Abstoma townei (Lloyd) Zeller
</td>
<td style="text-align:left;">
Abstoma townei
</td>
<td style="text-align:left;">
(Lloyd) Zeller
</td>
<td style="text-align:left;">
Fungi
</td>
<td style="text-align:left;">
Basidiomycota
</td>
<td style="text-align:left;">
Agaricomycetes
</td>
<td style="text-align:left;">
Agaricales
</td>
<td style="text-align:left;">
Agaricaceae
</td>
<td style="text-align:left;">
Abstoma
</td>
<td style="text-align:left;">
townei
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.6111111
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Acutocapillitium torrendii (Lloyd) P.Ponce de León
</td>
<td style="text-align:left;">
Acutocapillitium torrendii
</td>
<td style="text-align:left;">
(Lloyd) P.Ponce de León
</td>
<td style="text-align:left;">
Fungi
</td>
<td style="text-align:left;">
Basidiomycota
</td>
<td style="text-align:left;">
Agaricomycetes
</td>
<td style="text-align:left;">
Agaricales
</td>
<td style="text-align:left;">
Agaricaceae
</td>
<td style="text-align:left;">
Acutocapillitium
</td>
<td style="text-align:left;">
torrendii
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Aeruginospora furfuracea E.Horak
</td>
<td style="text-align:left;">
Aeruginospora furfuracea
</td>
<td style="text-align:left;">
E.Horak
</td>
<td style="text-align:left;">
Fungi
</td>
<td style="text-align:left;">
Basidiomycota
</td>
<td style="text-align:left;">
Agaricomycetes
</td>
<td style="text-align:left;">
Agaricales
</td>
<td style="text-align:left;">
Tricholomataceae
</td>
<td style="text-align:left;">
Aeruginospora
</td>
<td style="text-align:left;">
furfuracea
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.6666667
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Aeruginospora singularis Höhn.
</td>
<td style="text-align:left;">
Aeruginospora singularis
</td>
<td style="text-align:left;">
Höhn.
</td>
<td style="text-align:left;">
Fungi
</td>
<td style="text-align:left;">
Basidiomycota
</td>
<td style="text-align:left;">
Agaricomycetes
</td>
<td style="text-align:left;">
Agaricales
</td>
<td style="text-align:left;">
Tricholomataceae
</td>
<td style="text-align:left;">
Aeruginospora
</td>
<td style="text-align:left;">
singularis
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Agaricus abramsii Murrill
</td>
<td style="text-align:left;">
Agaricus abramsii
</td>
<td style="text-align:left;">
Murrill
</td>
<td style="text-align:left;">
Fungi
</td>
<td style="text-align:left;">
Basidiomycota
</td>
<td style="text-align:left;">
Agaricomycetes
</td>
<td style="text-align:left;">
Agaricales
</td>
<td style="text-align:left;">
Agaricaceae
</td>
<td style="text-align:left;">
Agaricus
</td>
<td style="text-align:left;">
abramsii
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0000000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Agaricus abruptibulbus Peck
</td>
<td style="text-align:left;">
Agaricus abruptibulbus
</td>
<td style="text-align:left;">
Peck
</td>
<td style="text-align:left;">
Fungi
</td>
<td style="text-align:left;">
Basidiomycota
</td>
<td style="text-align:left;">
Agaricomycetes
</td>
<td style="text-align:left;">
Agaricales
</td>
<td style="text-align:left;">
Agaricaceae
</td>
<td style="text-align:left;">
Agaricus
</td>
<td style="text-align:left;">
abruptibulbus
</td>
<td style="text-align:right;">
189
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1269841
</td>
<td style="text-align:right;">
93
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="tax.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter taxa based on collector bias</span></span>
<span id="cb7-2"><a href="tax.html#cb7-2" aria-hidden="true" tabindex="-1"></a>agaricales_enrich <span class="ot">&lt;-</span> agaricales_enrich[agaricales_enrich<span class="sc">$</span>max_bias<span class="sc">&lt;=</span><span class="fl">0.75</span>,]</span>
<span id="cb7-3"><a href="tax.html#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="tax.html#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#filter for taxa with at least 5 total records</span></span>
<span id="cb7-5"><a href="tax.html#cb7-5" aria-hidden="true" tabindex="-1"></a>agaricales_enrich <span class="ot">&lt;-</span> agaricales_enrich[agaricales_enrich<span class="sc">$</span>freq<span class="sc">&gt;=</span><span class="dv">5</span>,]</span>
<span id="cb7-6"><a href="tax.html#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="tax.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#make rectangular cladogram</span></span>
<span id="cb7-8"><a href="tax.html#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtree)</span>
<span id="cb7-9"><a href="tax.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-10"><a href="tax.html#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="tax.html#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">trait_clado</span>(<span class="at">data=</span>agaricales_enrich, <span class="at">trait_col=</span><span class="st">&quot;trait_ratio&quot;</span>, <span class="at">continuous=</span><span class="cn">TRUE</span>,</span>
<span id="cb7-12"><a href="tax.html#cb7-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">ladderize=</span><span class="cn">TRUE</span>, <span class="at">layout=</span><span class="st">&quot;rectangular&quot;</span>, <span class="at">size=</span><span class="fl">1.5</span>,</span>
<span id="cb7-13"><a href="tax.html#cb7-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">formula =</span> <span class="sc">~</span>new_order<span class="sc">/</span>new_family<span class="sc">/</span>new_genus<span class="sc">/</span>new_name, <span class="at">show=</span><span class="dv">100</span>)<span class="sc">+</span><span class="co">#make tree</span></span>
<span id="cb7-14"><a href="tax.html#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tiplab</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">offset =</span> <span class="fl">0.05</span>,</span>
<span id="cb7-15"><a href="tax.html#cb7-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">fontface =</span> <span class="st">&quot;italic&quot;</span>) <span class="sc">+</span> <span class="co">#add species labels</span></span>
<span id="cb7-16"><a href="tax.html#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tippoint</span>(<span class="at">shape=</span><span class="dv">15</span>, <span class="fu">aes</span>(<span class="at">color=</span>trait_ratio), <span class="at">size=</span><span class="fl">2.5</span>)<span class="sc">+</span><span class="co">#add tree tips</span></span>
<span id="cb7-17"><a href="tax.html#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours=</span> <span class="fu">c</span>(<span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>),</span>
<span id="cb7-18"><a href="tax.html#cb7-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">name =</span> <span class="st">&quot;Fire-associated records enrichment&quot;</span>,</span>
<span id="cb7-19"><a href="tax.html#cb7-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(agaricales_enrich<span class="sc">$</span>trait_ratio)<span class="sc">+</span></span>
<span id="cb7-20"><a href="tax.html#cb7-20" aria-hidden="true" tabindex="-1"></a>                                   (<span class="fl">0.01</span><span class="sc">*</span><span class="fu">max</span>(agaricales_enrich<span class="sc">$</span>trait_ratio))),</span>
<span id="cb7-21"><a href="tax.html#cb7-21" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="fu">guide_colourbar</span>(<span class="at">label.vjust =</span> <span class="fl">0.6</span>, </span>
<span id="cb7-22"><a href="tax.html#cb7-22" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">label.position =</span> <span class="st">&quot;left&quot;</span>, </span>
<span id="cb7-23"><a href="tax.html#cb7-23" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle =</span> <span class="dv">0</span>), </span>
<span id="cb7-24"><a href="tax.html#cb7-24" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">title.position =</span> <span class="st">&quot;right&quot;</span>, </span>
<span id="cb7-25"><a href="tax.html#cb7-25" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">nbin=</span><span class="dv">100</span>, </span>
<span id="cb7-26"><a href="tax.html#cb7-26" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">ticks.colour =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb7-27"><a href="tax.html#cb7-27" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">draw.ulim =</span> <span class="cn">FALSE</span>, </span>
<span id="cb7-28"><a href="tax.html#cb7-28" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">draw.llim =</span> <span class="cn">FALSE</span>, </span>
<span id="cb7-29"><a href="tax.html#cb7-29" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">barwidth =</span> .<span class="dv">5</span>, </span>
<span id="cb7-30"><a href="tax.html#cb7-30" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">barheight =</span> <span class="dv">14</span>))<span class="sc">+</span></span>
<span id="cb7-31"><a href="tax.html#cb7-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), </span>
<span id="cb7-32"><a href="tax.html#cb7-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">angle =</span> <span class="dv">270</span>),</span>
<span id="cb7-33"><a href="tax.html#cb7-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.5</span>, </span>
<span id="cb7-34"><a href="tax.html#cb7-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>, </span>
<span id="cb7-35"><a href="tax.html#cb7-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),</span>
<span id="cb7-36"><a href="tax.html#cb7-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb7-37"><a href="tax.html#cb7-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-38"><a href="tax.html#cb7-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line.x.bottom =</span> <span class="fu">element_line</span>(),</span>
<span id="cb7-39"><a href="tax.html#cb7-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(),</span>
<span id="cb7-40"><a href="tax.html#cb7-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb7-41"><a href="tax.html#cb7-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb7-42"><a href="tax.html#cb7-42" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb7-43"><a href="tax.html#cb7-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Taxonomic hierarchy&quot;</span>, </span>
<span id="cb7-44"><a href="tax.html#cb7-44" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.8</span>), </span>
<span id="cb7-45"><a href="tax.html#cb7-45" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </span>
<span id="cb7-46"><a href="tax.html#cb7-46" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;O&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;S&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:rect-clado"></span>
<img src="fungarium_book_files/figure-html/rect-clado-1.png" alt="Cladogram showing fire-association enrichment for top 100 Agaricales species with the highest enrichment" width="50%" />
<p class="caption">
Figure 2.1: Cladogram showing fire-association enrichment for top 100 Agaricales species with the highest enrichment
</p>
</div>
<p><strong>Example code for making circular trait cladogram:</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="tax.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#load sample enrichment data set for global Agaricales records</span></span>
<span id="cb8-2"><a href="tax.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(agaricales_enrich)</span>
<span id="cb8-3"><a href="tax.html#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="tax.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#filter taxa based on collector bias</span></span>
<span id="cb8-5"><a href="tax.html#cb8-5" aria-hidden="true" tabindex="-1"></a>agaricales_enrich <span class="ot">&lt;-</span> agaricales_enrich[agaricales_enrich<span class="sc">$</span>max_bias<span class="sc">&lt;=</span><span class="fl">0.75</span>,]</span>
<span id="cb8-6"><a href="tax.html#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="tax.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#filter for taxa with at least 5 total records</span></span>
<span id="cb8-8"><a href="tax.html#cb8-8" aria-hidden="true" tabindex="-1"></a>agaricales_enrich <span class="ot">&lt;-</span> agaricales_enrich[agaricales_enrich<span class="sc">$</span>freq<span class="sc">&gt;=</span><span class="dv">5</span>,]</span>
<span id="cb8-9"><a href="tax.html#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="tax.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#make circle cladogram</span></span>
<span id="cb8-11"><a href="tax.html#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggtree)</span>
<span id="cb8-12"><a href="tax.html#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-13"><a href="tax.html#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="tax.html#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">trait_clado</span>(<span class="at">data=</span>agaricales_enrich, <span class="at">trait_col=</span><span class="st">&quot;trait_ratio&quot;</span>, <span class="at">continuous=</span><span class="cn">TRUE</span>,</span>
<span id="cb8-15"><a href="tax.html#cb8-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">ladderize=</span><span class="cn">TRUE</span>, <span class="at">layout=</span><span class="st">&quot;circular&quot;</span>, <span class="at">size=</span><span class="fl">0.8</span>,</span>
<span id="cb8-16"><a href="tax.html#cb8-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">formula =</span> <span class="sc">~</span>new_order<span class="sc">/</span>new_family<span class="sc">/</span>new_genus<span class="sc">/</span>new_name, <span class="at">show=</span><span class="dv">300</span>)<span class="sc">+</span><span class="co">#make tree</span></span>
<span id="cb8-17"><a href="tax.html#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tiplab2</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">offset =</span> <span class="fl">0.1</span>,</span>
<span id="cb8-18"><a href="tax.html#cb8-18" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">1.3</span>, <span class="at">fontface =</span> <span class="st">&quot;italic&quot;</span>) <span class="sc">+</span> <span class="co">#add species labels</span></span>
<span id="cb8-19"><a href="tax.html#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tippoint</span>(<span class="at">shape=</span><span class="dv">20</span>, </span>
<span id="cb8-20"><a href="tax.html#cb8-20" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">color=</span>trait_ratio, <span class="at">size=</span>trait_freq), </span>
<span id="cb8-21"><a href="tax.html#cb8-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">alpha=</span><span class="fl">0.75</span>)<span class="sc">+</span><span class="co">#add tree tips</span></span>
<span id="cb8-22"><a href="tax.html#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours=</span> <span class="fu">c</span>(<span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>),</span>
<span id="cb8-23"><a href="tax.html#cb8-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">name =</span> <span class="st">&quot;Fire-associated records enrichment&quot;</span>,</span>
<span id="cb8-24"><a href="tax.html#cb8-24" aria-hidden="true" tabindex="-1"></a>                        <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(agaricales_enrich<span class="sc">$</span>trait_ratio)<span class="sc">+</span></span>
<span id="cb8-25"><a href="tax.html#cb8-25" aria-hidden="true" tabindex="-1"></a>                                   (<span class="fl">0.01</span><span class="sc">*</span><span class="fu">max</span>(agaricales_enrich<span class="sc">$</span>trait_ratio))),</span>
<span id="cb8-26"><a href="tax.html#cb8-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="fu">guide_colourbar</span>(<span class="at">label.vjust =</span> <span class="fl">0.6</span>,</span>
<span id="cb8-27"><a href="tax.html#cb8-27" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb8-28"><a href="tax.html#cb8-28" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb8-29"><a href="tax.html#cb8-29" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">nbin=</span><span class="dv">100</span>,</span>
<span id="cb8-30"><a href="tax.html#cb8-30" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">draw.ulim =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-31"><a href="tax.html#cb8-31" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">draw.llim =</span> <span class="cn">FALSE</span>,</span>
<span id="cb8-32"><a href="tax.html#cb8-32" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">barwidth =</span> <span class="dv">15</span>,</span>
<span id="cb8-33"><a href="tax.html#cb8-33" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">barheight =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb8-34"><a href="tax.html#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">name =</span> <span class="st">&quot;Fire-associated records&quot;</span>,</span>
<span id="cb8-35"><a href="tax.html#cb8-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">keywidth =</span> <span class="dv">2</span>,</span>
<span id="cb8-36"><a href="tax.html#cb8-36" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">keyheight =</span> <span class="dv">1</span>,</span>
<span id="cb8-37"><a href="tax.html#cb8-37" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">label.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb8-38"><a href="tax.html#cb8-38" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">label.vjust =</span> <span class="fl">0.6</span>,</span>
<span id="cb8-39"><a href="tax.html#cb8-39" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="at">angle =</span> <span class="dv">0</span>),</span>
<span id="cb8-40"><a href="tax.html#cb8-40" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">title.position =</span> <span class="st">&quot;top&quot;</span>)) <span class="sc">+</span></span>
<span id="cb8-41"><a href="tax.html#cb8-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb8-42"><a href="tax.html#cb8-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)),</span>
<span id="cb8-43"><a href="tax.html#cb8-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title.align =</span> <span class="fl">0.5</span>,</span>
<span id="cb8-44"><a href="tax.html#cb8-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb8-45"><a href="tax.html#cb8-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb8-46"><a href="tax.html#cb8-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb8-47"><a href="tax.html#cb8-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">margin=</span><span class="fu">margin</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)))<span class="sc">+</span></span>
<span id="cb8-48"><a href="tax.html#cb8-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>)<span class="co">#move root away from center;can help improve appearance of circle plot</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:circle-clado"></span>
<img src="fungarium_book_files/figure-html/circle-clado-1.png" alt="Circle cladogram showing fire-association enrichment for the top 300 Agaricales species with the highest enrichment" width="100%" />
<p class="caption">
Figure 2.2: Circle cladogram showing fire-association enrichment for the top 300 Agaricales species with the highest enrichment
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": null
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
